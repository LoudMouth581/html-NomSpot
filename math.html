<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Accounting Addition Bubble Pop Trainer</title>
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    body {
      margin: 0;
      background: radial-gradient(circle at center, #000010, #000000);
      color: #0ff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      user-select: none;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100vh;
      touch-action: manipulation;
    }
    #game {
      position: relative;
      width: 100vw;
      max-width: 480px;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 12px;
    }
    #header {
      width: 100%;
      display: flex;
      justify-content: space-between;
      font-weight: 700;
      font-size: 1.3rem;
      padding: 4px 12px;
      user-select: none;
    }
    #question {
      margin: 12px 0;
      font-size: 2.2rem;
      font-weight: 800;
      text-align: center;
      text-shadow: 0 0 8px #0ff;
      user-select: none;
    }
    #score {
      color: #0ff;
    }
    #timer {
      color: #0ff;
    }
    #bubbleContainer {
      position: relative;
      flex-grow: 1;
      width: 100%;
      overflow: hidden;
      background: radial-gradient(circle at bottom, #001011, #000000);
      border-radius: 16px;
      box-shadow: 0 0 15px #0ff inset;
      touch-action: manipulation;
    }
    .bubble {
      position: absolute;
      width: 70px;
      height: 70px;
      background: linear-gradient(135deg, #7ef9ff, #00fff7);
      clip-path: polygon(
        50% 0%, 61% 35%, 98% 35%, 68% 57%,
        79% 91%, 50% 70%, 21% 91%, 32% 57%,
        2% 35%, 39% 35%
      );
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      font-weight: 700;
      color: #00444d;
      text-shadow: 0 0 6px #00fff7;
      user-select: none;
      cursor: pointer;
      box-shadow: 0 0 10px #00fff7;
      transition: transform 0.2s ease;
      will-change: transform;
    }
    .bubble:hover {
      transform: scale(1.1);
      box-shadow: 0 0 18px #00fff7;
    }
    .pop {
      animation: popAnim 0.4s forwards;
    }
    @keyframes popAnim {
      to {
        transform: scale(2);
        opacity: 0;
      }
    }
    #feedback {
      height: 30px;
      text-align: center;
      margin-top: 6px;
      font-weight: 700;
      font-size: 1.2rem;
      min-height: 30px;
      user-select: none;
    }
    #startBtn {
      margin: 10px 0 6px;
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      background: #0ff;
      color: #00444d;
      font-weight: 700;
      font-size: 1.3rem;
      cursor: pointer;
      user-select: none;
      transition: background 0.3s ease;
    }
    #startBtn:hover:not(:disabled) {
      background: #00ccc7;
    }
    #startBtn:disabled {
      background: #006666;
      cursor: not-allowed;
    }
    /* Responsive text */
    @media (max-width: 400px) {
      #question {
        font-size: 1.8rem;
      }
      .bubble {
        width: 60px;
        height: 60px;
        font-size: 1.2rem;
      }
    }
  </style>
</head>
<body>
  <div id="game">
    <div id="header">
      <div id="score">Score: 0</div>
      <div id="timer">Time: 60</div>
    </div>
    <div id="question">Press Start to Begin</div>
    <div id="bubbleContainer"></div>
    <div id="feedback"></div>
    <button id="startBtn">Start Game</button>
  </div>

<script>
(() => {
  const scoreEl = document.getElementById('score');
  const timerEl = document.getElementById('timer');
  const questionEl = document.getElementById('question');
  const bubbleContainer = document.getElementById('bubbleContainer');
  const feedbackEl = document.getElementById('feedback');
  const startBtn = document.getElementById('startBtn');

  let score = 0;
  let timeLeft = 60;
  let timerInterval = null;
  let currentAnswer = null;
  let gameActive = false;
  const bubblesCount = 6;
  let bubbles = [];

  function randomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function generateQA() {
    const difficulty = Math.min(10 + Math.floor(score / 5), 99);
    const a = randomInt(1, difficulty);
    const b = randomInt(1, difficulty);
    currentAnswer = a + b;
    const question = `${a} + ${b}`;
    const answersSet = new Set([currentAnswer]);
    while (answersSet.size < bubblesCount) {
      let cand = currentAnswer + randomInt(-difficulty, difficulty);
      if (cand < 0) cand = 0;
      answersSet.add(cand);
    }
    const answersArr = Array.from(answersSet);
    for (let i = answersArr.length - 1; i > 0; i--) {
      const j = randomInt(0, i);
      [answersArr[i], answersArr[j]] = [answersArr[j], answersArr[i]];
    }
    return { question, answers: answersArr };
  }

  function createBubble(value) {
    const bubble = document.createElement('div');
    bubble.className = 'bubble';
    bubble.textContent = value;
    bubbleContainer.appendChild(bubble);

    const containerWidth = bubbleContainer.clientWidth;
    const maxX = containerWidth - 70;
    const leftPos = randomInt(0, maxX);
    const topPos = bubbleContainer.clientHeight + randomInt(0, 100);

    bubble.style.left = `${leftPos}px`;
    bubble.style.top = `${topPos}px`;

    return bubble;
  }

  function animateBubbles() {
    bubbles.forEach(b => {
      b.y -= b.speedY;
      b.x += b.speedX;

      if (b.x < 0) {
        b.x = 0;
        b.speedX = -b.speedX;
      } else if (b.x > bubbleContainer.clientWidth - 70) {
        b.x = bubbleContainer.clientWidth - 70;
        b.speedX = -b.speedX;
      }

      if (b.y < -80) {
        b.y = bubbleContainer.clientHeight + randomInt(0, 100);
        b.x = randomInt(0, bubbleContainer.clientWidth - 70);
        b.speedX = (Math.random() - 0.5) * 0.8;
        b.speedY = 0.8 + Math.random() * 0.6;
      }

      b.el.style.transform = `translate(${b.x}px, ${b.y}px)`;
    });
  }

  function popBubble(bubbleObj, correct) {
    bubbleObj.el.classList.add('pop');
    if (correct) {
      bubbleObj.el.style.background = '#0f0';
      bubbleObj.el.style.boxShadow = '0 0 15px #0f0';
    } else {
      bubbleObj.el.style.background = '#f33';
      bubbleObj.el.style.boxShadow = '0 0 15px #f33';
    }

    setTimeout(() => {
      if (bubbleObj.el && bubbleObj.el.parentNode) {
        bubbleObj.el.parentNode.removeChild(bubbleObj.el);
      }
    }, 400);
  }

  function setupBubbles(answers) {
    bubbleContainer.innerHTML = '';
    bubbles = [];

    answers.forEach(val => {
      const el = createBubble(val);
      const bubbleObj = {
        el,
        val,
        x: parseInt(el.style.left, 10),
        y: parseInt(el.style.top, 10),
        speedX: (Math.random() - 0.5) * 0.8,
        speedY: 0.8 + Math.random() * 0.6
      };
      bubbles.push(bubbleObj);

      el.addEventListener('click', () => {
        if (!gameActive) return;

        if (bubbleObj.val === currentAnswer) {
          score += 10;
          feedbackEl.textContent = '✅ Correct!';
          feedbackEl.style.color = '#0f0';
          popBubble(bubbleObj, true);
          updateScore();
          nextQuestion();
        } else {
          feedbackEl.textContent = '❌ Wrong! Try again!';
          feedbackEl.style.color = '#f33';
          popBubble(bubbleObj, false);
          score = Math.max(0, score - 5);
          updateScore();
        }
      });
    });
  }

  function nextQuestion() {
    const qa = generateQA();
    questionEl.textContent = qa.question;
    setupBubbles(qa.answers);
  }

  function updateScore() {
    scoreEl.textContent = `Score: ${score}`;
  }

  function startTimer() {
    timeLeft = 60;
    timerEl.textContent = `Time: ${timeLeft}`;
    timerInterval = setInterval(() => {
      timeLeft--;
      timerEl.textContent = `Time: ${timeLeft}`;
      if (timeLeft <= 0) {
        endGame();
      }
    }, 1000);
  }

  function endGame() {
    gameActive = false;
    clearInterval(timerInterval);
    questionEl.textContent = 'Game Over!';

    bubbleContainer.innerHTML = '';
    feedbackEl.textContent = `Your final score: ${score}`;

    startBtn.disabled = false;
    startBtn.textContent = 'Restart Game';
  }

  function startGame() {
    score = 0;
    updateScore();
    feedbackEl.textContent = '';
    startBtn.disabled = true;
    startBtn.textContent = 'Game in Progress...';
    gameActive = true;

    nextQuestion();
    startTimer();
  }

  function gameLoop() {
    if (gameActive) {
      animateBubbles();
    }
    requestAnimationFrame(gameLoop);
  }

  startBtn.addEventListener('click', startGame);
  gameLoop();

  bubbleContainer.addEventListener('touchmove', e => {
    if (gameActive) {
      e.preventDefault();
    }
  }, { passive: false });
})();
</script>

</body>
</html>
