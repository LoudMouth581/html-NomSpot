<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Math Mastery Quest</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(#f0f9ff, #cbebff);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      text-align: center;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 5px;
    }

    #titleBadge {
      font-size: 1.2rem;
      color: #555;
      margin-bottom: 15px;
    }

    #mascot {
      font-size: 3rem;
    }

    #mascotMsg {
      font-style: italic;
      margin: 5px 0 15px;
      min-height: 20px;
    }

    #question {
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    input[type="number"] {
      font-size: 1.4rem;
      padding: 8px;
      width: 100px;
      text-align: center;
    }

    button {
      padding: 10px 20px;
      font-size: 1.1rem;
      margin-top: 10px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    #feedback {
      margin-top: 15px;
      font-weight: bold;
      font-size: 1.2rem;
      min-height: 24px;
    }

    .correct { color: green; }
    .wrong { color: red; }

    #scoreboard {
      margin-top: 20px;
      font-size: 1rem;
    }

    #progressBar {
      width: 100%;
      background: #ccc;
      height: 10px;
      border-radius: 5px;
      margin-top: 10px;
    }

    #progress {
      height: 10px;
      width: 0%;
      background: #4caf50;
      border-radius: 5px;
    }

    #confetti {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 9999;
      display: none;
    }

    .confetti-piece {
      width: 10px;
      height: 10px;
      background: gold;
      position: absolute;
      animation: fall 1s linear forwards;
    }

    @keyframes fall {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(100vh); opacity: 0; }
    }
  </style>
</head>
<body>

  <h1>Math Mastery Quest</h1>
  <div id="titleBadge">üßë‚Äçüéì Math Novice</div>
  <div id="mascot">üòÉ</div>
  <div id="mascotMsg">Ready to begin?</div>
  <div id="question">Loading...</div>
  <input type="number" id="answerInput" placeholder="Your answer" />
  <br>
  <button onclick="submitAnswer()">Submit</button>
  <div id="feedback"></div>
  <div id="progressBar"><div id="progress"></div></div>
  <div id="scoreboard">Score: 0 | Streak: 0 | Level: 1 | Strikes: 0</div>
  <div id="confetti"></div>

  <script>
    const questionEl = document.getElementById("question");
    const answerInput = document.getElementById("answerInput");
    const feedbackEl = document.getElementById("feedback");
    const mascot = document.getElementById("mascot");
    const mascotMsg = document.getElementById("mascotMsg");
    const titleBadge = document.getElementById("titleBadge");
    const progressEl = document.getElementById("progress");
    const scoreboard = document.getElementById("scoreboard");
    const confettiContainer = document.getElementById("confetti");

    const correctSound = new Audio("https://www.soundjay.com/buttons/sounds/button-10.mp3");
    const wrongSound = new Audio("https://www.soundjay.com/buttons/sounds/button-16.mp3");
    const levelUpSound = new Audio("https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3");

    let correctAnswer = 0;
    let score = 0;
    let streak = 0;
    let level = 1;
    let strikes = 0;
    let timer;
    let timerStart;

    const titles = [
      "üßë‚Äçüéì Math Novice", "üß† Brain Booster", "üßô Wizard of Numbers",
      "ü•∑ Number Ninja", "üéì Equation Master", "üëë Alge-boss"
    ];

    function speak(text) {
      const msg = new SpeechSynthesisUtterance(text);
      msg.lang = "en-US";
      speechSynthesis.speak(msg);
    }

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function updateUI() {
      scoreboard.textContent = `Score: ${score} | Streak: ${streak} | Level: ${level} | Strikes: ${strikes}`;
      titleBadge.textContent = titles[Math.min(level - 1, titles.length - 1)];
      progressEl.style.width = `${(streak % 3) * 33.33}%`;
    }

    function generateQuestion() {
      clearTimeout(timer);
      const a = randomInt(1, 10 + level * 3);
      const b = randomInt(1, 10 + level * 3);
      correctAnswer = a + b;
      questionEl.textContent = `What is ${a} + ${b}?`;
      mascotMsg.textContent = `"Hmm... ${a} + ${b} is...?"`;
      answerInput.value = "";
      answerInput.focus();
      speak(questionEl.textContent);

      timerStart = Date.now();
      timer = setTimeout(() => {
        handleWrong("‚è±Ô∏è Too slow!");
      }, 10000);
    }

    function handleCorrect() {
      clearTimeout(timer);
      correctSound.play();
      const timeTaken = (Date.now() - timerStart) / 1000;
      let bonus = timeTaken <= 5 ? 10 : 5;
      score += bonus;
      streak++;
      mascot.textContent = "üòÑ";
      mascotMsg.textContent = `"Correct! +${bonus} points"`;
      feedbackEl.textContent = "‚úÖ Great job!";
      feedbackEl.className = "correct";

      if (streak % 3 === 0) {
        level++;
        levelUpSound.play();
        mascot.textContent = "üéâ";
        mascotMsg.textContent = `"Level Up! Welcome to Level ${level}!"`;
        showConfetti();
      }

      updateUI();
      setTimeout(generateQuestion, 1500);
    }

    function handleWrong(message = "‚ùå Oops, try again!") {
      clearTimeout(timer);
      wrongSound.play();
      strikes++;
      streak = Math.max(0, streak - 1);
      mascot.textContent = "üò¢";
      mascotMsg.textContent = `"${message}"`;
      feedbackEl.textContent = message;
      feedbackEl.className = "wrong";

      if (strikes >= 3) {
        level = Math.max(1, level - 1);
        strikes = 0;
        mascot.textContent = "üòû";
        mascotMsg.textContent = `"Too many mistakes. Dropping to level ${level}"`;
      }

      updateUI();
      setTimeout(generateQuestion, 1500);
    }

    function submitAnswer() {
      const val = parseInt(answerInput.value);
      if (isNaN(val)) {
        feedbackEl.textContent = "‚õî Please enter a number!";
        return;
      }
      if (val === correctAnswer) {
        handleCorrect();
      } else {
        handleWrong();
      }
    }

    function showConfetti() {
      confettiContainer.innerHTML = "";
      confettiContainer.style.display = "block";
      for (let i = 0; i < 50; i++) {
        const c = document.createElement("div");
        c.className = "confetti-piece";
        c.style.left = Math.random() * 100 + "%";
        c.style.animationDuration = (0.5 + Math.random()).toFixed(2) + "s";
        confettiContainer.appendChild(c);
      }
      setTimeout(() => confettiContainer.style.display = "none", 1200);
    }

    // Start game
    updateUI();
    generateQuestion();
  </script>
</body>
</html>
