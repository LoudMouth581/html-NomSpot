<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Geometry</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      max-width: 650px;
    }
    h1 {
      text-align: center;
    }
    #controls {
      margin-bottom: 15px;
    }
    button.shapeBtn {
      padding: 8px 16px;
      margin-right: 10px;
      font-size: 16px;
      cursor: pointer;
    }
    #explanationBox {
      margin-top: 15px;
      border: 1px solid #888;
      padding: 12px;
      background: #f9f9f9;
      min-height: 80px;
    }
    svg {
      border: 1px solid #ccc;
      margin-top: 15px;
      touch-action: none;
    }
    .dimLabel {
      font-size: 14px;
      fill: #333;
      user-select: none;
    }
    .handle {
      fill: #faa;
      stroke: #d33;
      stroke-width: 2;
      cursor: grab;
    }
    line {
      stroke: #555;
      stroke-width: 2;
      stroke-dasharray: 4 2;
    }
    #quiz {
      margin-top: 30px;
      border-top: 2px solid #ccc;
      padding-top: 15px;
    }
    #quiz h2 {
      margin-bottom: 10px;
    }
    #quiz button {
      margin: 8px 5px;
      padding: 8px 16px;
      font-size: 16px;
    }
    #quizResult {
      margin-top: 15px;
      font-weight: bold;
      font-size: 18px;
    }
    #nextQuestionBtn {
      margin-top: 10px;
      padding: 8px 16px;
      font-size: 16px;
    }
    #mascot {
      font-size: 48px;
      text-align: center;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>

  <h1>Geometry</h1>
  <div id="mascot">ðŸ”¶</div>

  <div id="controls">
    <button class="shapeBtn" onclick="loadShape('circle')">Circle</button>
    <button class="shapeBtn" onclick="loadShape('rectangle')">Rectangle</button>
    <button class="shapeBtn" onclick="loadShape('triangle')">Triangle</button>
    <button class="shapeBtn" onclick="startQuiz()">Start Quiz</button>
  </div>

  <div id="explanationBox">
    Click a shape above to begin learning its formulas and how area works.
  </div>

  <svg id="svgCanvas" width="320" height="320" aria-label="Interactive shape"></svg>

  <div id="quiz" style="display:none;">
    <h2>Quiz Time!</h2>
    <div id="quizQuestion"></div>
    <div id="quizChoices"></div>
    <button id="nextQuestionBtn" onclick="nextQuestion()" style="display:none;">Next Question</button>
    <div id="quizResult"></div>
  </div>

<script>
  const svg = document.getElementById('svgCanvas');
  const explanationBox = document.getElementById('explanationBox');
  const quizDiv = document.getElementById('quiz');
  const quizQuestion = document.getElementById('quizQuestion');
  const quizChoices = document.getElementById('quizChoices');
  const nextQuestionBtn = document.getElementById('nextQuestionBtn');
  const quizResult = document.getElementById('quizResult');
  const mascot = document.getElementById('mascot');

  // Shape data
  let circle = { radius: 80 };
  let rect = { width: 160, height: 100 };
  let tri = { base: 150, height: 100 };

  // Quiz questions (multiâ€‘level)
  const quizQuestions = [
    // Basic
    {
      question: "Formula for area of circle?",
      choices: ["Ï€ Ã— rÂ²", "2Ï€r", "r + r", "Ï€ Ã— d"],
      answer: 0
    },
    {
      question: "A rectangle: width 10, height 5 â†’ area?",
      choices: ["15", "50", "20", "5"],
      answer: 1
    },
    {
      question: "Triangle area = (base Ã— height) Ã· 2",
      choices: ["True", "False"],
      answer: 0
    },
    // Intermediate
    {
      question: "If radius doubles, area becomes?",
      choices: ["Doubles", "Quadruples", "Halves", "Same"],
      answer: 1
    },
    {
      question: "Rectangle perimeter formula?",
      choices: ["2(w + h)", "w + h", "w Ã— h", "w^2 + h^2"],
      answer: 0
    },
    {
      question: "Triangle base 8, height 5 â†’ area?",
      choices: ["13", "40", "20", "10"],
      answer: 3
    },
    // Math Genius
    {
      question: "Exact area of circle with r = 5?",
      choices: ["25Ï€", "10Ï€", "5Ï€", "Ï€"],
      answer: 0
    },
    {
      question: "Rectangle length tripled, width halved â†’ area becomes?",
      choices: ["Same", "Doubled", "Tripled", "Halved"],
      answer: 0
    },
    {
      question: "Triangle sides 3,4,5 (right triangle) area?",
      choices: ["6", "12", "7.5", "5"],
      answer: 0
    }
  ];
  let quizIndex = 0;
  let quizScore = 0;

  function speak(text) {
    if (!window.speechSynthesis) return;
    window.speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'en-US';
    window.speechSynthesis.speak(u);
  }

  function clearSvg() {
    while (svg.firstChild) svg.removeChild(svg.firstChild);
  }

  function loadShape(shape) {
    clearSvg();
    quizDiv.style.display = "none";
    if (shape === 'circle') {
      mascot.textContent = "ðŸŸ ";
      explainCircle();
      drawCircle();
    } else if (shape === 'rectangle') {
      mascot.textContent = "ðŸŸ¦";
      explainRectangle();
      drawRectangle();
    } else if (shape === 'triangle') {
      mascot.textContent = "ðŸ”º";
      explainTriangle();
      drawTriangle();
    }
  }

  function explainCircle() {
    const text = `
      <b>Circle</b><br>
      Radius (r): from center to edge.<br>
      Formula: <i>Area = Ï€ Ã— rÂ²</i>.<br>
      As r increases, area grows quickly.<br>
      Drag the handle to change r and see area update.
    `;
    explanationBox.innerHTML = text;
    speak("You selected circle. The radius is from center to edge. The formula is pi times radius squared.");
  }

  function drawCircle() {
    const cx = 160, cy = 160;

    const circleEl = document.createElementNS("http://www.w3.org/2000/svg","circle");
    circleEl.setAttribute("cx", cx);
    circleEl.setAttribute("cy", cy);
    circleEl.setAttribute("r", circle.radius);
    svg.appendChild(circleEl);

    const lineEl = document.createElementNS("http://www.w3.org/2000/svg","line");
    lineEl.setAttribute("x1", cx);
    lineEl.setAttribute("y1", cy);
    lineEl.setAttribute("x2", cx + circle.radius);
    lineEl.setAttribute("y2", cy);
    svg.appendChild(lineEl);

    const handle = document.createElementNS("http://www.w3.org/2000/svg","circle");
    handle.setAttribute("cx", cx + circle.radius);
    handle.setAttribute("cy", cy);
    handle.setAttribute("r", 10);
    handle.setAttribute("class", "handle");
    svg.appendChild(handle);

    const rLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    rLabel.setAttribute("x", cx + circle.radius / 2);
    rLabel.setAttribute("y", cy - 10);
    rLabel.setAttribute("class", "dimLabel");
    rLabel.textContent = `r = ${circle.radius}`;
    svg.appendChild(rLabel);

    const areaLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    areaLabel.setAttribute("x", cx);
    areaLabel.setAttribute("y", cy + circle.radius + 30);
    areaLabel.setAttribute("class", "dimLabel");
    areaLabel.setAttribute("text-anchor", "middle");
    areaLabel.textContent = `Area â‰ˆ ${(Math.PI * circle.radius * circle.radius).toFixed(2)}`;
    svg.appendChild(areaLabel);

    let dragging = false;

    function updateR(nr) {
      if (nr < 10) nr = 10;
      if (nr > 140) nr = 140;
      circle.radius = nr;
      circleEl.setAttribute("r", nr);
      lineEl.setAttribute("x2", cx + nr);
      handle.setAttribute("cx", cx + nr);
      rLabel.setAttribute("x", cx + nr/2);
      rLabel.textContent = `r = ${Math.round(nr)}`;
      areaLabel.setAttribute("y", cy + nr + 30);
      areaLabel.textContent = `Area â‰ˆ ${(Math.PI * nr * nr).toFixed(2)}`;
    }

    handle.addEventListener("pointerdown", e => {
      dragging = true;
      handle.setPointerCapture(e.pointerId);
    });
    window.addEventListener("pointerup", e => { dragging = false; });
    window.addEventListener("pointermove", e => {
      if (!dragging) return;
      const bb = svg.getBoundingClientRect();
      let x = e.clientX - bb.left;
      let newr = x - cx;
      updateR(newr);
    });
  }

  function explainRectangle() {
    const text = `
      <b>Rectangle</b><br>
      Dimensions: width (w) and height (h).<br>
      Formula: <i>Area = w Ã— h</i>.<br>
      Also: <i>Perimeter = 2(w + h)</i>.<br>
      Drag width or height handles to change area.
    `;
    explanationBox.innerHTML = text;
    speak("You selected rectangle. You need width and height. Area is width times height, and perimeter is two times width plus height.");
  }

  function drawRectangle() {
    const sx = 80, sy = 80;

    const rectEl = document.createElementNS("http://www.w3.org/2000/svg","rect");
    rectEl.setAttribute("x", sx);
    rectEl.setAttribute("y", sy);
    rectEl.setAttribute("width", rect.width);
    rectEl.setAttribute("height", rect.height);
    svg.appendChild(rectEl);

    const wHandle = document.createElementNS("http://www.w3.org/2000/svg","circle");
    wHandle.setAttribute("cx", sx + rect.width);
    wHandle.setAttribute("cy", sy + rect.height/2);
    wHandle.setAttribute("r", 10);
    wHandle.setAttribute("class","handle");
    svg.appendChild(wHandle);

    const hHandle = document.createElementNS("http://www.w3.org/2000/svg","circle");
    hHandle.setAttribute("cx", sx + rect.width/2);
    hHandle.setAttribute("cy", sy + rect.height);
    hHandle.setAttribute("r", 10);
    hHandle.setAttribute("class","handle");
    svg.appendChild(hHandle);

    const wLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    wLabel.setAttribute("x", sx + rect.width/2);
    wLabel.setAttribute("y", sy + rect.height + 20);
    wLabel.setAttribute("class","dimLabel");
    wLabel.textContent = `w = ${rect.width}`;
    svg.appendChild(wLabel);

    const hLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    hLabel.setAttribute("x", sx - 10);
    hLabel.setAttribute("y", sy + rect.height/2);
    hLabel.setAttribute("text-anchor","end");
    hLabel.setAttribute("class","dimLabel");
    hLabel.textContent = `h = ${rect.height}`;
    svg.appendChild(hLabel);

    const areaLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    areaLabel.setAttribute("x", sx + rect.width/2);
    areaLabel.setAttribute("y", sy + rect.height/2);
    areaLabel.setAttribute("class","dimLabel");
    areaLabel.textContent = `Area = ${rect.width * rect.height}`;
    svg.appendChild(areaLabel);

    let dragW = false, dragH = false;

    function updateW(nw) {
      if (nw < 20) nw = 20;
      if (nw > 300) nw = 300;
      rect.width = nw;
      rectEl.setAttribute("width", nw);
      wHandle.setAttribute("cx", sx + nw);
      wLabel.setAttribute("x", sx + nw/2);
      wLabel.textContent = `w = ${Math.round(nw)}`;
      areaLabel.textContent = `Area = ${Math.round(rect.width * rect.height)}`;
    }
    function updateH(nh) {
      if (nh < 20) nh = 20;
      if (nh > 300) nh = 300;
      rect.height = nh;
      rectEl.setAttribute("height", nh);
      hHandle.setAttribute("cy", sy + nh);
      hLabel.setAttribute("y", sy + nh/2);
      hLabel.textContent = `h = ${Math.round(nh)}`;
      areaLabel.textContent = `Area = ${Math.round(rect.width * rect.height)}`;
    }

    wHandle.addEventListener("pointerdown", e => {
      dragW = true;
      wHandle.setPointerCapture(e.pointerId);
    });
    hHandle.addEventListener("pointerdown", e => {
      dragH = true;
      hHandle.setPointerCapture(e.pointerId);
    });
    window.addEventListener("pointerup", e => {
      dragW = dragH = false;
    });
    window.addEventListener("pointermove", e => {
      const bb = svg.getBoundingClientRect();
      const x = e.clientX - bb.left;
      const y = e.clientY - bb.top;

      if (dragW) {
        let newW = x - sx;
        updateW(newW);
      }
      if (dragH) {
        let newH = y - sy;
        updateH(newH);
      }
    });
  }

  function explainTriangle() {
    const text = `
      <b>Triangle (rightâ€‘angled)</b><br>
      Base (b) and Height (h).<br>
      Area formula: <i>Area = (b Ã— h) Ã· 2</i>.<br>
      Drag base or height to see area change.
    `;
    explanationBox.innerHTML = text;
    speak("You selected triangle. For a right triangle, the area is base times height divided by two. Try dragging the base or height handles to see area change.");
  }

  function drawTriangle() {
    const sx = 80, sy = 220;

    const pol = document.createElementNS("http://www.w3.org/2000/svg","polygon");
    svg.appendChild(pol);

    const bHandle = document.createElementNS("http://www.w3.org/2000/svg","circle");
    bHandle.setAttribute("class","handle");
    svg.appendChild(bHandle);

    const hHandle = document.createElementNS("http://www.w3.org/2000/svg","circle");
    hHandle.setAttribute("class","handle");
    svg.appendChild(hHandle);

    const bLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    bLabel.setAttribute("class","dimLabel");
    svg.appendChild(bLabel);

    const hLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    hLabel.setAttribute("class","dimLabel");
    hLabel.setAttribute("text-anchor","end");
    svg.appendChild(hLabel);

    const areaLabel = document.createElementNS("http://www.w3.org/2000/svg","text");
    areaLabel.setAttribute("class","dimLabel");
    svg.appendChild(areaLabel);

    function updateTri() {
      pol.setAttribute('points', `${sx},${sy} ${sx + tri.base},${sy} ${sx},${sy - tri.height}`);
      bHandle.setAttribute('cx', sx + tri.base);
      bHandle.setAttribute('cy', sy);
      hHandle.setAttribute('cx', sx);
      hHandle.setAttribute('cy', sy - tri.height);

      bLabel.setAttribute('x', sx + tri.base/2);
      bLabel.setAttribute('y', sy + 20);
      bLabel.textContent = `b = ${Math.round(tri.base)}`;

      hLabel.setAttribute('x', sx - 20);
      hLabel.setAttribute('y', sy - tri.height/2);
      hLabel.textContent = `h = ${Math.round(tri.height)}`;

      const area = (tri.base * tri.height) / 2;
      areaLabel.setAttribute('x', sx + tri.base/3);
      areaLabel.setAttribute('y', sy - tri.height/3);
      areaLabel.textContent = `Area = ${Math.round(area)}`;
    }

    tri.base = tri.base;
    tri.height = tri.height;
    updateTri();

    let dragB = false, dragH = false;

    bHandle.addEventListener("pointerdown", e => {
      dragB = true;
      bHandle.setPointerCapture(e.pointerId);
    });
    hHandle.addEventListener("pointerdown", e => {
      dragH = true;
      hHandle.setPointerCapture(e.pointerId);
    });
    window.addEventListener("pointerup", e => {
      dragB = dragH = false;
    });
    window.addEventListener("pointermove", e => {
      const bb = svg.getBoundingClientRect();
      const x = e.clientX - bb.left;
      const y = e.clientY - bb.top;

      if (dragB) {
        let nb = x - sx;
        if (nb < 20) nb = 20;
        if (nb > 300) nb = 300;
        tri.base = nb;
        updateTri();
      }
      if (dragH) {
        let nh = sy - y;
        if (nh < 20) nh = 20;
        if (nh > 300) nh = 300;
        tri.height = nh;
        updateTri();
      }
    });
  }

  // --- Quiz logic ---
  function startQuiz() {
    clearSvg();
    explanationBox.innerHTML = "Now it's quiz time! Answer these to test your knowledge.";
    quizDiv.style.display = "block";
    quizIndex = 0;
    quizScore = 0;
    quizResult.textContent = "";
    nextQuestionBtn.style.display = "none";
    showQuizQuestion();
  }

  function showQuizQuestion() {
    quizChoices.innerHTML = "";
    nextQuestionBtn.style.display = "none";

    if (quizIndex >= quizQuestions.length) {
      quizQuestion.textContent = `Quiz complete! You scored ${quizScore} / ${quizQuestions.length}.`;
      quizResult.textContent = quizScore >= Math.ceil(quizQuestions.length * 0.7)
        ? "Bravo! You are a math genius!"
        : "Nice effort! Keep practicing.";
      return;
    }

    const q = quizQuestions[quizIndex];
    quizQuestion.innerHTML = `<strong>Q${quizIndex + 1}:</strong> ${q.question}`;
    speak(q.question);

    q.choices.forEach((c, i) => {
      const btn = document.createElement("button");
      btn.textContent = c;
      btn.onclick = () => {
        if (i === q.answer) {
          quizScore++;
          quizResult.textContent = "Correct!";
        } else {
          quizResult.textContent = `Wrong! The correct answer was "${q.choices[q.answer]}"`;
        }
        Array.from(quizChoices.children).forEach(b => b.disabled = true);
        nextQuestionBtn.style.display = "inline-block";
      };
      quizChoices.appendChild(btn);
    });
  }

  function nextQuestion() {
    quizResult.textContent = "";
    quizIndex++;
    showQuizQuestion();
  }

  // On first load, draw circle by default
  loadShape('circle');

</script>

</body>
</html>
