<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>World Leaders Birthcharts & 7 Continents Real-Time Tracker</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');

  body {
    margin: 0; padding: 1rem;
    background: #0a0a1f;
    color: #ccc;
    font-family: 'Orbitron', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }

  h1, h2 {
    color: #00ffff;
    text-shadow: 0 0 10px #00ffff;
    margin-bottom: 1rem;
  }

  .card {
    background: #121231;
    border: 2px solid #00ffff;
    border-radius: 12px;
    padding: 1rem;
    width: 320px;
    box-shadow: 0 0 15px #00ffffaa;
    margin-bottom: 2rem;
  }

  .leaders {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    justify-content: center;
    width: 90%;
    max-width: 1200px;
  }

  .leader-card, .continent-card {
    background: #121231;
    border-radius: 12px;
    padding: 1rem;
    width: 280px;
    box-shadow: 0 0 15px #00ffffaa;
    outline-offset: 2px;
  }

  .leader-card {
    border: 2px solid #00ffff;
  }

  .leader-card h2, .continent-card h3 {
    margin-top: 0;
    color: #00ffff;
  }

  /* Chakra colors for continents */
  .chakra-root    { border: 2px solid #e53935; box-shadow: 0 0 15px #e53935aa; }
  .chakra-sacral  { border: 2px solid #fb8c00; box-shadow: 0 0 15px #fb8c00aa; }
  .chakra-solarPlexus { border: 2px solid #fdd835; box-shadow: 0 0 15px #fdd835aa; color: #fff; }
  .chakra-heart   { border: 2px solid #43a047; box-shadow: 0 0 15px #43a047aa; }
  .chakra-throat  { border: 2px solid #1e88e5; box-shadow: 0 0 15px #1e88e5aa; }
  .chakra-thirdEye{ border: 2px solid #8e24aa; box-shadow: 0 0 15px #8e24aaaa; }
  .chakra-crown   { border: 2px solid #6a1b9a; box-shadow: 0 0 15px #6a1b9aaa; }

  .chakra-meter, .nostrodomus-meter {
    margin-top: 1rem;
  }

  .chakra-label, .nostrodomus-label {
    font-weight: 700;
    font-size: 0.9rem;
  }

  .chakra-bar, .nostrodomus-bar {
    background: #222244;
    height: 14px;
    border-radius: 8px;
    overflow: hidden;
    margin-top: 2px;
  }

  .chakra-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ffff, #006666);
    width: 0;
    transition: width 1s ease;
  }

  .nostrodomus-fill {
    height: 100%;
    background: linear-gradient(90deg, #ffcc00, #ffaa00);
    width: 0;
    transition: width 1s ease;
  }

  .birth-chart {
    font-size: 0.85rem;
    margin-top: 1rem;
    line-height: 1.3;
    color: #80ffff;
  }

  .location-info {
    font-size: 0.9rem;
    margin-top: 0.5rem;
    color: #88eeff;
  }

  /* Responsive */
  @media (max-width: 700px) {
    .leaders {
      flex-direction: column;
      align-items: center;
    }
  }
</style>
</head>
<body>

<h1>World Leaders Birthcharts & 7 Continents Real-Time Tracker</h1>

<!-- Meter Card -->
<div class="card" id="user-location-card" tabindex="0" aria-live="polite" aria-atomic="true">
  <div>Loading your location and code...</div>
</div>

<!-- Leaders Section -->
<div class="leaders" id="leaders-container" aria-label="World Leaders Birthcharts"></div>

<!-- Continents Section -->
<h2>Continents Birthchart & Astrology</h2>
<div class="leaders" id="continents-container" aria-label="Continents Birthcharts"></div>

<script>
  function reduceNum(n) {
    while (n > 9) {
      n = n.toString().split('').reduce((a, b) => a + +b, 0);
    }
    return n;
  }

  async function getMoonPhase() {
    const knownNewMoon = new Date('2023-01-06T23:07:00Z').getTime();
    const now = Date.now();
    const msPerDay = 1000 * 60 * 60 * 24;
    const daysSince = Math.floor((now - knownNewMoon) / msPerDay);
    return daysSince % 30;
  }

  async function calculateMysticCode(longitude, latitude) {
    const lonStr = Math.abs(longitude).toFixed(4).replace('.', '');
    const latStr = Math.abs(latitude).toFixed(4).replace('.', '');
    let sum = 0;
    for (const ch of (lonStr + latStr)) sum += parseInt(ch, 10);
    const moonPhase = await getMoonPhase();
    let combined = sum + moonPhase;
    return reduceNum(combined);
  }

  function renderMeter(code) {
    const meterWidth = code * 10;
    return `
      <div class="nostrodomus-meter" aria-label="karmic code meter">
        <div class="nostrodomus-label">Code: ${code}</div>
        <div class="nostrodomus-bar">
          <div class="nostrodomus-fill" style="width:${meterWidth}%"></div>
        </div>
      </div>
    `;
  }

  async function displayUserLocation(longitude, latitude) {
    const card = document.getElementById('user-location-card');
    const code = await calculateMysticCode(longitude, latitude);

    card.innerHTML = `
      <div><strong>Longitude:</strong> ${longitude.toFixed(4)}</div>
      <div><strong>Latitude:</strong> ${latitude.toFixed(4)}</div>
      ${renderMeter(code)}
      <div class="location-info"></div>
    `;
  }

  function fetchIPLocation() {
    console.log('Fetching IP location...');
    return fetch('https://ip-api.com/json/')
      .then(res => res.json())
      .then(data => {
        console.log('IP Location data:', data);
        if (data.lat && data.lon) {
          return { latitude: data.lat, longitude: data.lon };
        } else {
          throw new Error('No location data');
        }
      });
  }

  function getUserLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(async (pos) => {
        await displayUserLocation(pos.coords.longitude, pos.coords.latitude);
      }, async (err) => {
        console.error('Geolocation error:', err);
        try {
          const loc = await fetchIPLocation();
          await displayUserLocation(loc.longitude, loc.latitude);
        } catch (e) {
          console.error('IP location fetch failed:', e);
          document.getElementById('user-location-card').innerText = 'Unable to determine location.';
        }
      }, {timeout: 10000});
    } else {
      fetchIPLocation()
        .then(loc => displayUserLocation(loc.longitude, loc.latitude))
        .catch(() => {
          document.getElementById('user-location-card').innerText = 'Location not supported or available.';
        });
    }
  }

  getUserLocation();

  const leaders = [
    {
      name: "Donald Trump",
      dob: "1946-06-14T10:54:00Z",
      birthChart: {
        sun: "Gemini", moon: "Sagittarius", rising: "Leo",
        elements: "Air, Fire", notableAspects: "Sun conjunct Venus, Moon trine Mars",
        houses: "1st House Sun, 7th House Moon", aspects: "Conjunction, Trine"
      },
      chakras: { root: 70, sacral: 50, solarPlexus: 40, heart: 65, throat: 60, thirdEye: 55, crown: 35 }
    },
    {
      name: "Xi Jinping",
      dob: "1953-06-15T10:30:00Z",
      birthChart: {
        sun: "Gemini", moon: "Pisces", rising: "Cancer",
        elements: "Air, Water", notableAspects: "Sun square Neptune, Moon sextile Venus",
        houses: "2nd House Sun, 8th House Moon", aspects: "Square, Sextile"
      },
      chakras: { root: 55, sacral: 60, solarPlexus: 45, heart: 50, throat: 70, thirdEye: 60, crown: 45 }
    }
  ];

  function createLeaderCard(leader) {
    const card = document.createElement('div');
    card.classList.add('leader-card');
    card.setAttribute('tabindex', '0');
    card.innerHTML = `
      <h2>${leader.name}</h2>
      <div><strong>DOB:</strong> ${new Date(leader.dob).toUTCString()}</div>
      <div class="birth-chart">
        <div><strong>Sun:</strong> ${leader.birthChart.sun}</div>
        <div><strong>Moon:</strong> ${leader.birthChart.moon}</div>
        <div><strong>Rising:</strong> ${leader.birthChart.rising}</div>
        <div><strong>Elements:</strong> ${leader.birthChart.elements}</div>
        <div><strong>Houses:</strong> ${leader.birthChart.houses}</div>
        <div><strong>Aspects:</strong> ${leader.birthChart.aspects}</div>
        <div><strong>Notable Aspects:</strong> ${leader.birthChart.notableAspects}</div>
      </div>
      <div class="chakra-meter">
        ${Object.entries(leader.chakras).map(([k, v]) => `
          <div>
            <span class="chakra-label">${k.replace(/([A-Z])/g, ' $1')}</span>
            <div class="chakra-bar"><div class="chakra-fill" style="width:${v}%;"></div></div>
          </div>
        `).join('')}
      </div>
    `;
    return card;
  }

  const leadersContainer = document.getElementById('leaders-container');
  leaders.forEach(l => leadersContainer.appendChild(createLeaderCard(l)));

  const continents = [
    { name: "Africa", chakra: "root", birthChart: { sun: "Cancer", moon: "Leo", elements: "Water, Fire", notableAspects: "Sun trine Jupiter", houses: "5th/11th", aspects: "Trine" }},
    { name: "Asia", chakra: "solarPlexus", birthChart: { sun: "Virgo", moon: "Taurus", elements: "Earth, Air", notableAspects: "Sun sextile Mercury", houses: "1st/7th", aspects: "Sextile" }},
    { name: "Europe", chakra: "heart", birthChart: { sun: "Libra", moon: "Gemini", elements: "Air", notableAspects: "Sun opposite Mars", houses: "2nd/8th", aspects: "Opposition" }},
    { name: "North America", chakra: "throat", birthChart: { sun: "Gemini", moon: "Cancer", elements: "Air, Water", notableAspects: "Sun conjunct Mercury", houses: "1st/7th", aspects: "Conjunction" }},
    { name: "Oceania", chakra: "thirdEye", birthChart: { sun: "Sagittarius", moon: "Aquarius", elements: "Fire, Air", notableAspects: "Sun trine Jupiter", houses: "3rd/9th", aspects: "Trine" }},
    { name: "South America", chakra: "crown", birthChart: { sun: "Pisces", moon: "Scorpio", elements: "Water", notableAspects: "Sun conjunct Neptune", houses: "4th/10th", aspects: "Conjunction" }}
  ];

  function createContinentCard(c) {
    const card = document.createElement('div');
    card.classList.add('continent-card', `chakra-${c.chakra}`);
    card.setAttribute('tabindex', '0');
    card.innerHTML = `
      <h3>${c.name}</h3>
      <div class="birth-chart">
        <div><strong>Sun:</strong> ${c.birthChart.sun}</div>
        <div><strong>Moon:</strong> ${c.birthChart.moon}</div>
        <div><strong>Elements:</strong> ${c.birthChart.elements}</div>
        <div><strong>Houses:</strong> ${c.birthChart.houses}</div>
        <div><strong>Aspects:</strong> ${c.birthChart.aspects}</div>
        <div><strong>Notable Aspects:</strong> ${c.birthChart.notableAspects}</div>
      </div>
    `;
    return card;
  }

  const continentsContainer = document.getElementById('continents-container');
  continents.forEach(c => continentsContainer.appendChild(createContinentCard(c)));
</script>

</body>
</html>

