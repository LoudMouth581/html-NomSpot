<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NomSpot Taste Tagger & Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="styles.css" rel="stylesheet">
  <style>
    body { font-family: Arial, sans-serif; padding: 1rem; }
    button { margin: 0.25rem; padding: 0.5rem 1rem; border: none; background: #6698cb; color: white; border-radius: 4px; cursor: pointer; }
    .tag-group { margin-bottom: 1rem; }
    .selected-tags { margin-top: 1rem; padding: 1rem; background: #f0f0f0; border-radius: 5px; }
    #chat-box, #private-chat-box { border: 1px solid #ccc; padding: 0.5rem; height: 200px; overflow-y: auto; background: #fff; margin-bottom: 1rem; }
    .chat-message { padding: 0.2rem 0; }
    input[type="text"] { width: calc(100% - 80px); padding: 0.5rem; margin-right: 0.5rem; }
    #sketchpad { border: 2px dashed #333; background: #fafafa; display: block; margin: 1rem 0; }
  </style>
</head>
<body>
  <header>
    <h1>NomSpot Taste Tagger</h1>
  </header>

  <main>
    <!-- Taste Tagging Section -->
    <section id="tag-section">
      <h2>Tag Your Food (Primary / Secondary / Mood)</h2>
      <!-- same structure as before -->
    </section>

    <!-- Community Chat -->
    <section id="chat-section">
      <h2>Public Chat</h2>
      <div id="chat-box"></div>
      <input type="text" id="chatInput" placeholder="Public chat…" />
      <button onclick="sendMessage()">Send</button>
    </section>

    <!-- Private AIM-style Chat -->
    <section id="private-chat-section">
      <h2>Private Chat with a Member</h2>
      <input type="text" id="targetUser" placeholder="@username" />
      <button onclick="startPrivateChat()">Start Chat</button>
      <div id="private-chat-box"></div>
      <input type="text" id="privateInput" placeholder="Type privately…" />
      <button onclick="sendPrivateMessage()">Send</button>
    </section>

    <!-- Sketch/Doodle Board -->
    <section id="sketch-section">
      <h2>Doodle Sketchpad</h2>
      <canvas id="sketchpad" width="400" height="300"></canvas>
      <button onclick="clearCanvas()">Clear</button>
    </section>
  </main>

  <footer>
    &copy; 2025 NomSpot
  </footer>

  <script>
    // Tag system code (as before)
    const tags = { primary: null, secondary: null, mood: null };
    function selectTag(type, value) { tags[type] = value; updateDisplay(); }
    function updateDisplay() { 
      document.getElementById('selectedDisplay').textContent = 
        `Primary: ${tags.primary || '–'}, Secondary: ${tags.secondary || '–'}, Mood: ${tags.mood || '–'}`;
    }

    // Public Chat
    function sendMessage() {
      const txt = document.getElementById('chatInput').value.trim();
      if (!txt) return;
      const p = document.createElement('div');
      p.className = 'chat-message';
      p.textContent = `You: ${txt}`;
      document.getElementById('chat-box').appendChild(p);
      document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;
      document.getElementById('chatInput').value = '';
    }

    // Private Chat (frontend simulated)
    let privateMessages = {};
    let currentTarget = null;
    function startPrivateChat() {
      const target = document.getElementById('targetUser').value.trim();
      if (!target) return alert('Enter a username');
      currentTarget = target;
      if (!privateMessages[target]) privateMessages[target] = [];
      renderPrivateChat();
    }
    function sendPrivateMessage() {
      const txt = document.getElementById('privateInput').value.trim();
      if (!txt || !currentTarget) return;
      privateMessages[currentTarget].push(`You -> ${currentTarget}: ${txt}`);
      document.getElementById('privateInput').value = '';
      renderPrivateChat();
    }
    function renderPrivateChat() {
      const box = document.getElementById('private-chat-box');
      box.innerHTML = '';
      privateMessages[currentTarget].forEach(msg => {
        const d = document.createElement('div');
        d.className = 'chat-message';
        d.textContent = msg;
        box.appendChild(d);
      });
      box.scrollTop = box.scrollHeight;
    }

    // Sketchpad Initialization
    const canvas = document.getElementById('sketchpad');
    const ctx = canvas.getContext('2d');
    let drawing = false;

    canvas.addEventListener('mousedown', () => drawing = true);
    canvas.addEventListener('mouseup', () => drawing = false);
    canvas.addEventListener('mouseout', () => drawing = false);
    canvas.addEventListener('mousemove', (e) => {
      if (!drawing) return;
      const rect = canvas.getBoundingClientRect();
      ctx.fillStyle = '#333';
      ctx.beginPath();
      ctx.arc(e.clientX - rect.left, e.clientY - rect.top, 2, 0, 2 * Math.PI);
      ctx.fill();
    });
    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }
  </script>
</body>
</html>
